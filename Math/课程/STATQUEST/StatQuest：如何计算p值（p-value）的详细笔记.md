# **StatQuest：如何计算p值（p-value）的详细笔记**

---

## **1. 什么是p值（p-value）？**

- **p值（p-value）**是在**假设检验**中使用的概率，用于判断观测结果是否与**原假设（\(H_0\)）**一致。  
- p值表示：**在原假设成立的情况下**，得到当前结果或**更极端结果**的概率。
- **p值的解释：**
  - **小p值**（如 \(p < 0.05\)）：我们可以拒绝原假设，认为数据存在显著性差异。
  - **大p值**（如 \(p \geq 0.05\)）：未能拒绝原假设，数据的差异可能是**随机误差**造成的。

---

## **2. p值的两种类型：单侧和双侧**

### **2.1 双侧p值（Two-Sided p-value）**
- **双侧p值**用于检验结果在**两个方向**上的显著性。
- 适用于测试两个变量是否**有任何差异**（无论差异在何方向上）。
  
### **2.2 单侧p值（One-Sided p-value）**
- **单侧p值**只检验结果在**一个方向**上的显著性。  
- 适用于明确知道差异的方向时使用，但容易忽略反方向上的异常。

---

## **3. 投掷硬币的p值计算示例**

### **3.1 简单示例：两次投掷都是正面**

1. **实验设计：**
   - 投掷硬币两次，结果均为正面。

2. **原假设（\(H_0\)**）：  
   - 假设硬币是**公平的**，即正面和反面出现的概率均为0.5。

3. **计算步骤：**
   - **每次投掷的概率**：  
     \(P(\text{正面}) = 0.5\)，\(P(\text{反面}) = 0.5\)。  
   - **四种可能结果：**  
     - 正面-正面  
     - 正面-反面  
     - 反面-正面  
     - 反面-反面  

   - **得到两个正面的概率：**
     \[
     P(\text{正面-正面}) = 0.5 \times 0.5 = 0.25
     \]

4. **p值计算：**
   - **观察到的结果**为两个正面，概率为0.25。
   - **同样极端的结果**：得到两个反面的概率也为0.25。
     \[
     p = 0.25 + 0.25 = 0.5
     \]

5. **结论：**  
   - 由于 \(p = 0.5\) 大于 0.05，我们未能拒绝原假设，结果可能是**随机**的。

---

### **3.2 复杂示例：五次投掷中的p值**

1. **实验设计：**
   - 投掷硬币五次，结果为**四次正面，一次反面**。

2. **计算步骤：**
   - 总共有 \(2^5 = 32\) 种可能结果。
   - **得到4次正面1次反面的概率：**
     \[
     P(4\text{正} + 1\text{反}) = \frac{5}{32}
     \]
   - **同样罕见的情况**：1次正面4次反面的概率也为：
     \[
     P(1\text{正} + 4\text{反}) = \frac{5}{32}
     \]
   - **极端情况**：5次全正或5次全反的概率分别为：
     \[
     P(5\text{正}) = P(5\text{反}) = \frac{1}{32}
     \]

3. **p值计算：**
   \[
   p = \frac{5}{32} + \frac{5}{32} + \frac{2}{32} = 0.375
   \]

4. **结论：**
   - 由于 \(p = 0.375\) 大于 0.05，我们**未能拒绝原假设**，结果并不表明硬币不公平。

---

## **4. 使用连续分布计算p值**

### **示例：身高数据的p值计算**

1. **假设的分布：**  
   - 某组人的平均身高为155.7厘米，数据呈正态分布。

2. **问题：**  
   - 我们想知道某人身高为**142厘米**的概率是否显著。

3. **p值计算：**
   - 142厘米是该分布的下界，其中**95%数据**落在**142到169厘米**之间。
   - **小于142厘米的概率：**
     \[
     P(X < 142) = 0.025
     \]
   - **大于169厘米的概率：**
     \[
     P(X > 169) = 0.025
     \]
   - **总p值：**
     \[
     p = 0.025 + 0.025 = 0.05
     \]

4. **结论：**
   - \(p = 0.05\) 处于阈值边界，因此无法确定142厘米是否显著异常。

---

## **5. p值计算中的关键因素**

1. **样本大小：**
   - 样本越大，越容易检测到微小差异，但也可能导致微小的无关差异变得显著。

2. **阈值选择：**
   - 常用阈值为0.05，但在高风险领域（如医学研究）可能需要更严格的阈值（如0.01或0.001）。

3. **单侧与双侧测试：**
   - **单侧测试**更适合检测特定方向的变化，但可能遗漏反方向上的显著变化。

---

## **6. p值计算公式：T检验**

1. **T检验公式：**
   \[
   t = \frac{\bar{X_1} - \bar{X_2}}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}
   \]
   - \( \bar{X_1} \) 和 \( \bar{X_2} \)：两个样本的均值  
   - \( s_1^2 \) 和 \( s_2^2 \)：两个样本的方差  
   - \( n_1 \) 和 \( n_2 \)：两个样本的大小

2. **查找p值：**
   - 根据计算出的t值，在t分布表中找到相应的p值。

---

## **7. p值的应用与解释**

1. **p值与效果大小：**
   - p值只能反映**显著性**，而**不能直接反映差异的大小**。

2. **p值的局限性：**
   - 仅凭p值无法判断实验设计是否合理，需结合**效果大小**和**置信区间**进行解释。

3. **假阳性与假阴性：**
   - 假阳性：错误地拒绝了原假设。
   - 假阴性：错误地未能拒绝原假设。

---

## **8. 总结：如何计算与解读p值**

1. **p值计算的核心**：  
   - 观察结果的概率 + 同样罕见结果的概率 + 更极端结果的概率。

2. **单侧与双侧p值的区别**：  
   - 单侧测试只检测一个方向的显著性，双侧测试检测两个方向的显著性。

3. **如何使用p值：**
   - **p < 0.05**：拒绝原假设，认为差异显著。  
   - **p ≥ 0.05**：未能拒绝原假设。

---

## **9. 最后的话：Quest On!**

- 如果你喜欢本次StatQuest并希望学习更多，请**订阅**我们的频道！  
- 有任何问题或建议，请在**评论区留言**！

---

**Quest On!** 🎯