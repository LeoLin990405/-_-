# **StatQuest：p值操纵（p-hacking）及其避免方法详细笔记**

---

## **1. 什么是p-hacking？**

- **p-hacking**是指研究者通过**选择性地处理和分析数据**，多次测试和筛选结果，使实验数据呈现出**假阳性（false positive）**，即p值小于0.05的统计显著性。  
- **p-hacking的危害**：
  - 误导研究结论，降低科学研究的**可信度**和**可重复性**。
  - 导致看似显著的结果实际上是**随机误差**的产物。

---

## **2. p-hacking的典型示例：开发药物的实验**

1. **研究目标：**
   - 测试不同药物对**缩短病人恢复时间**的效果。

2. **实验流程：**
   - **药物A测试**：3名患者服用药物A，没有显著效果。
   - **药物B测试**：3名患者服用药物B，结果也无显著效果。
   - 依次测试药物C、D，均无显著效果。

3. **滥用p值的情况：**
   - **测试到药物E**，意外发现恢复时间显著缩短，**p值 = 0.02**。
   - 尽管药物E的结果看似显著，但由于多次测试的原因，该显著性可能只是**随机误差**。

4. **p-hacking问题：**
   - 多次实验增加了发现**假阳性**的概率。
   - 每次实验都有5%的概率误判为显著性，重复测试多次后几乎一定会出现假阳性。

---

## **3. p-hacking的机制：多重比较问题**

### **3.1 多重比较（Multiple Testing Problem）**

- 每次使用p值阈值0.05的检验，都有**5%的概率**出现假阳性结果。
- 当进行**多次测试**时，假阳性结果的概率会**大幅上升**：
  - **10次测试**中，出现假阳性的概率为：  
    $$
    [
    1 - (1 - 0.05)^{10} \approx 0.4
    ]
    $$
    
    - 即：10次测试中大约40%的概率会出现假阳性。

### **3.2 如何理解p-hacking的风险**

- **多次尝试不同方法**或**调整样本大小**，直到发现显著结果，这些都属于p-hacking的表现。
- 这种做法会导致数据呈现虚假的**显著性**，结果可能**无法重复**。

---

## **4. 避免p-hacking的统计方法**

### **4.1 错误发现率（False Discovery Rate, FDR）**

- **错误发现率（FDR）**是通过调整p值来减少假阳性的统计方法。
- **原理：**在多次测试时，对所有p值进行校正，确保整体错误率保持在合理范围内。

### **4.2 FDR校正的计算方法**

- **Benjamini-Hochberg校正**：对所有p值排序，并按以下公式调整：
  $$
  [
  p_{\text{调整}}(i) = \frac{p(i) \cdot n}{i}
  ]
  $$
  
  - 其中：  
    - \(p(i)\) 是第\(i\)个排序后的p值。  
    - \(n\) 是所有测试的数量。
  
- **FDR校正的效果：**
  - 校正后，部分原本显著的结果可能不再显著，从而减少假阳性。

---

## **5. p-hacking的常见形式及避免策略**

### **5.1 数据筛选和选择性报告**

- **问题：**只报告显著结果而忽略不显著结果，是典型的p-hacking行为。  
- **避免方法：**：
  - **透明化数据**：报告所有测试的结果，而不仅是显著的部分。
  - **注册实验设计**：在实验前公开设计方案，防止事后筛选数据。

---

### **5.2 添加样本点来调整p值**

- **问题：**当初始结果不显著时，研究者可能会**增加样本**直到结果变得显著。
- **避免方法：**
  - 在实验前进行**功效分析（Power Analysis）**，确定合适的样本量。

---

## **6. 功效分析（Power Analysis）：控制样本量的工具**

### **6.1 功效分析的目的**

- **功效分析**帮助我们确定**所需的样本量**，确保实验结果足够准确，同时避免p-hacking。

### **6.2 功效分析的步骤**

1. **输入参数：**
   - **预期效果大小（Effect Size）**
   - **显著性水平**（通常为0.05）
   - **功效（Power）**：通常设置为0.8，表示80%的概率能正确检测到差异。

2. **计算结果：**  
   - 根据输入参数计算出所需的**样本量**，避免在实验过程中随意添加样本。

---

## **7. 单侧与双侧p值的选择：避免滥用**

- **单侧检验（One-Sided Test）**只检测一个方向的差异，容易忽略反方向的显著结果。  
- **双侧检验（Two-Sided Test）**更加严谨，适合大多数实验。

---

## **8. 透明化与多重比较校正：避免p-hacking的关键**

1. **透明化报告：**
   - **全面报告所有结果**，包括不显著的部分，防止选择性报告。
   
2. **多重比较校正：**
   - 使用**FDR**或**Bonferroni校正**来调整p值，减少多重测试带来的假阳性。

---

## **9. 总结：如何避免p-hacking？**

1. **规划合理的实验设计：**
   - 在实验前进行**功效分析**，确定合适的样本量。

2. **透明化数据处理与报告：**
   - **完整报告**所有测试结果，而不仅是显著的部分。

3. **多重比较校正：**
   - 使用**错误发现率（FDR）**或**Bonferroni校正**调整p值，减少假阳性。

4. **避免选择性增加样本：**
   - 不要在实验过程中随意添加样本以获取显著结果。

---

## **10. 最后的话：Quest On!**

- **p-hacking**会误导研究结果，降低研究的可信度，因此避免p-hacking对科学研究至关重要。  
- 如果你喜欢本次StatQuest并希望学习更多内容，请**订阅**我们的频道！  
- 有任何问题或建议，请在**评论区留言**！

---

**Quest On!** 🎯