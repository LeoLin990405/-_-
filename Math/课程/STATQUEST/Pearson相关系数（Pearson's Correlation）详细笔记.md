# **Pearson相关系数（Pearson's Correlation）详细笔记**

---

## **1. 什么是 Pearson 相关系数？**

- **Pearson相关系数**用于衡量两个变量之间**线性关系的强度和方向**。  
- 它帮助我们回答以下问题：**当一个变量变化时，另一个变量是否按比例变化？**
- 其值范围是 $[-1, 1]$，具体解释如下：
  - **$r = 1$**：完全正相关，所有数据点落在一条正斜率的直线上。  
  - **$r = -1$**：完全负相关，所有数据点落在一条负斜率的直线上。  
  - **$r = 0$**：没有线性关系。

---

## **2. Pearson 相关系数的公式**

### **公式**：

$$
r = \frac{\text{Cov}(X, Y)}{\sqrt{\text{Var}(X) \cdot \text{Var}(Y)}}
$$

- **$r$**：Pearson相关系数  
- **$\text{Cov}(X, Y)$**：$X$ 和 $Y$ 的协方差，表示两个变量同时变化的趋势。  
- **$\text{Var}(X)$ 和 $\text{Var}(Y)$**：$X$ 和 $Y$ 的方差，分别表示每个变量值的分散程度。

---

## **3. 计算 Pearson 相关系数的步骤**

1. **计算均值**：
   - $ \bar{X} = \frac{1}{n} \sum_{i=1}^{n} X_i $  
   - $ \bar{Y} = \frac{1}{n} \sum_{i=1}^{n} Y_i $

2. **计算协方差**：
   $$
   \text{Cov}(X, Y) = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{n - 1}
   $$

3. **计算方差**：
   - $ \text{Var}(X) = \frac{\sum_{i=1}^{n} (X_i - \bar{X})^2}{n - 1} $  
   - $ \text{Var}(Y) = \frac{\sum_{i=1}^{n} (Y_i - \bar{Y})^2}{n - 1} $

4. **代入公式计算 Pearson 相关系数**：
   $$
   r = \frac{\text{Cov}(X, Y)}{\sqrt{\text{Var}(X) \cdot \text{Var}(Y)}}
   $$

---

## **4. Pearson 相关系数的性质**

1. **尺度无关性**：  
   - Pearson相关系数不受变量的单位和尺度影响。例如，将变量从米转换为厘米不会改变 $r$ 的值。

2. **方向性与强度**：
   - **$r > 0$**：正相关，即一个变量增加时，另一个变量也增加。  
   - **$r < 0$**：负相关，即一个变量增加时，另一个变量减少。  
   - **$|r| = 1$**：表示完全线性关系。  
   - **$|r| \approx 0$**：关系非常弱或没有关系。

3. **范围限制**：  
   - Pearson相关系数的值严格限制在 $[-1, 1]$ 之间。

4. **不代表因果关系**：  
   - 高相关性表明变量之间存在关联，但不一定存在因果关系。

---

## **5. Pearson 相关系数的应用**

1. **数据分析和统计建模**：  
   - 检测两个变量之间是否存在线性关系。

2. **金融分析**：  
   - 衡量两个资产之间的关联性，例如股票之间的价格变化趋势。

3. **心理学和社会科学**：  
   - 用于研究行为变量之间的关系，例如学习时间与考试成绩之间的关联。

---

## **6. 计算 Pearson 相关系数的示例**

### 示例数据：

- **Gene X**：$[10, 20, 30, 40, 50]$  
- **Gene Y**：$[15, 25, 35, 45, 55]$

### **计算步骤：**

1. **计算均值**：
   - $\bar{X} = 30$  
   - $\bar{Y} = 35$

2. **计算协方差**：
   $$
   \text{Cov}(X, Y) = \frac{(10 - 30)(15 - 35) + \dots + (50 - 30)(55 - 35)}{4} = 250
   $$

3. **计算方差**：
   $$
   \text{Var}(X) = \frac{(10 - 30)^2 + \dots + (50 - 30)^2}{4} = 250
   $$
   $$
   \text{Var}(Y) = \frac{(15 - 35)^2 + \dots + (55 - 35)^2}{4} = 250
   $$

4. **计算 Pearson 相关系数**：
   $$
   r = \frac{250}{\sqrt{250 \cdot 250}} = 1
   $$

---

## **7. 小数据集的风险**

- **少量数据点可能误导结果**：即使两个随机点之间也可以画出一条直线，使相关系数为 $r = 1$。  
- **增加数据点**会减少误判的概率，并提高结果的可靠性。

---

## **8. 相关系数与p值**

1. **p值的意义**：  
   - **p值**表示观察到的相关性可能由随机因素导致的概率。

2. **示例**：  
   - 如果 $p = 0.03$，意味着在无关系假设成立的情况下，有3%的概率会观察到如此强或更强的关系。

---

## **9. R平方（$R^2$）与相关系数**

- **$R^2$**表示模型解释的数据方差比例：  
  $$
  R^2 = r^2
  $$

- **解释**：  
   - 如果 $R^2 = 0.81$，表示模型解释了81%的数据方差。

---

## **10. Pearson 相关系数的局限性**

1. **仅检测线性关系**：  
   - Pearson相关系数只能检测线性关系，无法捕捉非线性关系。

2. **不代表因果关系**：  
   - 高相关性并不意味着两个变量之间存在因果关系，需要进一步分析验证。

---

## **11. 总结**

1. **Pearson相关系数**衡量两个变量之间的线性关系强度和方向。  
2. **取值范围**：$r$ 的取值范围是 $[-1, 1]$。  
3. **p值**帮助判断观察到的相关性是否显著。  
4. **R平方（$R^2$）**用于描述模型解释的数据方差比例。  
5. **应用**：广泛用于金融、社会科学和自然科学领域。

---

## **12. 最后的话：Quest On!**

- 如果你喜欢本次StatQuest并希望学习更多内容，请**订阅**我们的频道！  
- 如有任何问题或建议，请在**评论区留言**！  
- 支持StatQuest：你可以购买我的音乐、T恤或捐赠，链接在描述中。

---

**Quest On!** 🎯