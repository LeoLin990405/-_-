# **StatQuest：功效分析（Power Analysis）详细笔记**

---

## **1. 什么是功效分析（Power Analysis）？**

- **功效分析（Power Analysis）**是一种用于确定**合适样本量**的统计工具，确保实验具有足够的**功效（Power）**来检测真实存在的差异。  
- **统计功效（Power）**定义为**在备择假设（$H_1$）成立时，正确拒绝原假设（$H_0$）的概率**：
  $$
  \text{Power} = 1 - \beta
  $$
  - 其中 $\beta$ 是**第二类错误（Type II Error）**的概率，即**未能发现真实差异的概率**。

### **1.1 为什么功效分析很重要？**
- 如果实验的功效不足，即使存在差异，实验也可能无法检测到，导致**假阴性（False Negative）**。  
- **功效分析的目的**是确保样本量足够，从而使实验结果具有足够的统计意义。

---

## **2. 统计功效与错误类型**

1. **第一类错误（Type I Error）**：  
   - 误拒原假设，即错误地认为两组数据存在显著差异（**假阳性**）。  
   - **概率**：$\alpha$（通常设为0.05）。

2. **第二类错误（Type II Error）**：  
   - 未能发现真实差异，即错误地接受原假设（**假阴性**）。  
   - **概率**：$\beta$。

3. **功效与错误类型的关系**：
   - 统计功效衡量的是**避免第二类错误的能力**：
     $$
     \text{Power} = 1 - \beta
     $$

---

## **3. 功效分析的四大关键要素**

1. **显著性水平（$\alpha$）：**  
   - 通常设为0.05，表示有5%的概率出现第一类错误。

2. **功效（Power）：**  
   - 通常设为0.8，即希望在80%的情况下能够正确拒绝原假设。

3. **效应量（Effect Size）：**  
   - 表示两组数据之间的差异大小。  
   - **公式**：
     $$
     d = \frac{\bar{X_1} - \bar{X_2}}{s_p}
     $$
     - 其中 $\bar{X_1}$ 和 $\bar{X_2}$ 为两组的均值，$s_p$ 为合并标准差（Pooled Standard Deviation）。

4. **样本量（Sample Size）：**  
   - 样本量越大，功效越高。

---

## **4. 合并标准差的计算**

- **合并标准差（Pooled Standard Deviation）**是用于多个组之间的标准差的加权平均：
  $$
  s_p = \sqrt{\frac{(n_1 - 1) \cdot s_1^2 + (n_2 - 1) \cdot s_2^2}{n_1 + n_2 - 2}}
  $$
  - 其中 $s_1$ 和 $s_2$ 是两组的样本标准差，$n_1$ 和 $n_2$ 是两组的样本大小。

---

## **5. 如何使用功效分析确定样本量？**

### **5.1 示例：药物实验中的功效分析**

1. **实验设计：**  
   - 比较两种药物（A和B）对患者恢复时间的影响。

2. **已知数据：**
   - 药物A的均值：50小时，标准差：7小时。  
   - 药物B的均值：60小时，标准差：6小时。

3. **合并标准差计算：**
   $$
   s_p = \sqrt{\frac{(7^2 + 6^2)}{2}} = 6.5
   $$

4. **效应量计算：**
   $$
   d = \frac{60 - 50}{6.5} = 1.54
   $$

5. **功效分析结果：**  
   - 假设显著性水平 $\alpha = 0.05$，功效设为0.8。  
   - 经过计算，得到每组需要至少**9个样本**。

---

## **6. 如何增加统计功效？**

1. **增加样本量：**  
   - 样本量越大，实验的统计功效越高。

2. **减少数据的噪声和分布重叠：**  
   - 优化实验设计，减少组间重叠，提高检测差异的能力。

3. **提高效应量：**  
   - 如果组间差异更大，则功效更高。

4. **放宽显著性水平 $\alpha$：**  
   - 如果将 $\alpha$ 提高到0.1，功效会增加，但第一类错误的概率也会增加。

---

## **7. 分布重叠与功效的关系**

- **分布重叠较少：**较小的样本量即可检测出差异，功效较高。  
- **分布高度重叠：**需要更大的样本量来检测差异，否则功效会降低。

---

## **8. 功效分析工具与实践**

- 功效分析工具可以帮助我们快速计算**样本量**、**功效**和**显著性水平**的关系。  
- 常用工具包括：
  - **G*Power**：一款免费且功能强大的功效分析软件。
  - **在线计算器**：许多网站提供简单的功效分析工具。

---

## **9. 小样本实验的风险与功效不足**

1. **小样本实验的风险：**
   - 样本量不足会导致p值不稳定，可能无法检测到真实差异。

2. **示例：每组3只老鼠的实验**
   - p值波动较大，偶尔可能出现假阳性或假阴性。

3. **结论：**  
   - 在实验前进行功效分析，确保样本量足够，可以减少误判的风险。

---

## **10. 透明化实验设计与报告**

1. **提前规划实验：**  
   - 在实验开始前进行功效分析，避免事后调整样本量。

2. **报告所有结果：**  
   - 不论结果是否显著，都应透明报告，避免数据筛选和p-hacking行为。

---

## **11. 统计功效的关键总结**

1. **统计功效（Power）**衡量我们检测到真实差异的能力：
   $$
   \text{Power} = 1 - \beta
   $$

2. **功效不足**可能导致未能发现实际存在的差异（假阴性）。  
3. **增加样本量**、**减少噪声**和**提高效应量**是提高功效的有效方法。  
4. **功效分析**帮助我们提前确定合适的样本量，确保实验设计科学合理。

---

## **12. 最后的话：Quest On!**

- 功效分析是确保实验结果可靠的关键工具。  
- 如果你喜欢本次StatQuest并希望学习更多，请**订阅**我们的频道！  
- 有任何问题或建议，请在**评论区留言**！

---

**Quest On!** 🎯