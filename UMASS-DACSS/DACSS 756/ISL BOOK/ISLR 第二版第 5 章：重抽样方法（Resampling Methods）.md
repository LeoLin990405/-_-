# ISLR 第二版第 5 章：重抽样方法（Resampling Methods）

## 5.1 重抽样方法概述

### 重抽样方法简介
- **重抽样方法**通过**多次抽样**和**重复拟合**来分析数据
- 主要用途：
  1. 估计模型的**测试误差**
  2. **选择最佳模型**
  3. **估计参数的标准误差**

### 常用重抽样方法
1. **交叉验证**：估计模型测试误差
2. **自助法**：评估统计量准确性和构建置信区间

## 5.2 交叉验证（Cross-Validation）

### 5.2.1 验证集法（Validation Set Approach）

#### 方法概述
- 将数据随机分为**训练集**和**验证集**
- 均方误差计算：

$$MSE = \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2$$

其中：
- $y_i$ 是真实响应值
- $\hat{y}_i$ 是模型预测值

### 5.2.2 留一法交叉验证（LOOCV）

#### LOOCV误差计算
每次留出一个观测作为验证：

$$CV_{(n)} = \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i^{(-i)})^2$$

其中：
- $\hat{y}_i^{(-i)}$ 是去掉第 $i$ 个观测后的预测值

#### 线性回归的快捷公式

$$CV_{(n)} = \frac{1}{n} \sum_{i=1}^n \left(\frac{y_i - \hat{y}_i}{1 - h_i}\right)^2$$

其中：
- $h_i$ 是第 $i$ 个观测的杠杆值

### 5.2.3 $k$ 折交叉验证（k-Fold Cross-Validation）

#### 方法概述
- 将数据随机分为 $k$ 个大小相近的子集
- $k$ 折交叉验证误差计算：

$$CV_{(k)} = \frac{1}{k} \sum_{i=1}^k MSE_i$$

其中 $MSE_i$ 是第 $i$ 折的均方误差

#### 选择 $k$ 的考虑因素
1. **计算成本**：$k$ 越大，计算量越大
2. **偏差-方差权衡**：
   - $k$ 较小：计算快但偏差可能较大
   - $k$ 较大：偏差小但方差可能较大
3. **常用选择**：$k=5$ 或 $k=10$

## 5.3 自助法（Bootstrap）

### 5.3.1 基本原理
- 通过**有放回抽样**生成新的数据集
- 每个自助样本大小与原始数据集相同
- 某个观测被选中的概率：$1-(1-\frac{1}{n})^n \approx 0.632$ （当 $n$ 较大）

### 5.3.2 标准误估计

#### 自助法标准误计算

$$SE_B(\hat{\theta}) = \sqrt{\frac{1}{B-1} \sum_{r=1}^B (\hat{\theta}^{*(r)} - \bar{\theta}^*)^2}$$

其中：
- $B$ 是自助样本数量
- $\hat{\theta}^{*(r)}$ 是第 $r$ 个自助样本的统计量估计
- $\bar{\theta}^*$ 是 $B$ 个自助估计的平均值

### 5.3.3 置信区间构建

#### 百分位法置信区间
- $\alpha$ 水平的置信区间：$[\hat{\theta}^*_{(\alpha/2)}, \hat{\theta}^*_{(1-\alpha/2)}]$
- 例如，95%置信区间使用第2.5和97.5百分位数

### 5.3.4 .632 自助法估计

$$\hat{err}_{.632} = 0.368 \cdot \hat{err}_{train} + 0.632 \cdot \hat{err}_{boot}$$

其中：
- $\hat{err}_{train}$ 是训练误差
- $\hat{err}_{boot}$ 是自助法误差

## 5.4 方法比较与选择

### 5.4.1 不同方法的适用场景

1. **验证集法**：
   - 适用于大数据集
   - 计算快速
   - 结果不稳定

2. **LOOCV**：
   - 适用于小数据集
   - 计算量大
   - 结果稳定
   - 高方差

3. **k折交叉验证**：
   - 平衡计算效率和稳定性
   - 结果相对稳定
   - 广泛应用

4. **自助法**：
   - 估计复杂统计量的标准误
   - 构建置信区间
   - 处理小样本数据

### 5.4.2 实践建议

1. **模型评估**：
   - 大数据集：使用验证集法或k折交叉验证
   - 小数据集：考虑LOOCV

2. **参数不确定性**：
   - 使用自助法估计标准误
   - 构建置信区间

3. **计算资源考虑**：
   - 权衡计算成本和估计精度
   - 根据实际需求选择合适的方法

## 5.5 总结

### 关键点
1. 重抽样方法提供了评估模型性能的有力工具
2. 不同方法各有优缺点，需要根据具体情况选择
3. 交叉验证主要用于模型评估和选择
4. 自助法适用于参数不确定性的评估

### 实践注意事项
1. 数据集大小影响方法选择
2. 计算资源限制需要考虑
3. 结果稳定性的重要性
4. 方法的假设条件要注意