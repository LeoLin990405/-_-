好的，以下是适合本科生自学的更加详细的Nim游戏与组合博弈论笔记。我会分章节逐步讲解每个概念和公式的推导，并详细解释每个步骤，以确保知识点易于理解。 

---

## 第一章：Nim游戏与组合博弈

### 1.1 章节目标
本章的目标是：
1. 介绍组合博弈的基本概念，特别是Nim游戏的规则和数学解析方法。
2. 讨论Nim游戏中的重要数学工具，如二进制系统和异或运算（XOR）。
3. 通过定义、定理和证明，用数学的方式来分析组合博弈中的赢法策略。

### 1.2 学习目标
通过本章的学习，您应该能够：
- 理解Nim游戏的规则，并掌握Nim游戏的最优策略。
- 掌握组合博弈中“游戏和”“等价游戏”“Nim值”和mex规则的概念。
- 应用这些方法去分析和玩其他无偏游戏（Impartial Games），例如一些简单的棋类游戏。

---

### 1.3 推荐阅读

以下是与组合博弈和Nim游戏相关的推荐书籍：
- **《Introducing Game Theory and Its Applications》, Elliot Mendelson**：概述了Nim游戏的数学基础和基本的博弈策略。
- **Charles Bouton的“《Nim, a game with a complete mathematical theory》”**：1902年发表的经典论文，首次提出了Nim游戏的完整解法。
- **《Winning Ways for Your Mathematical Plays》, Berlekamp、Conway和Guy**：经典的组合博弈论著作，深入探讨了Nim游戏和其他组合博弈。

---

### 1.4 什么是组合博弈？

**组合博弈**是一类数学博弈的总称，它具备以下主要特征：
1. **完美信息（Perfect Information）**：所有玩家在任何时刻都能完全看到游戏的当前状态和所有可能的选择。例如，在Nim游戏中，每位玩家都能看到堆中剩余的物品数量。
  
2. **无随机性（No Chance Moves）**：游戏中没有任何随机元素，例如掷骰子或抽牌等。

3. **无偏性（Impartial Game）**：玩家在任何状态下的行动选择仅取决于当前状态，而与玩家的身份无关。即无论是先手或后手，玩家的合法操作是相同的，这与偏好性游戏（如国际象棋，白棋和黑棋的操作不同）不同。

4. **结束条件明确（Definite End Condition）**：游戏不会无限进行下去，最终必定会结束。在组合博弈中，无法再移动的一方判输。

#### 常见例子
常见的组合博弈包括国际象棋、围棋、跳棋、井字棋以及Nim游戏。组合博弈因其严格的数学性质，使得我们可以用数学方式去分析和研究其赢法策略。

---

### 1.5 Nim游戏的规则和基本策略

**Nim游戏规则**：
1. 游戏包含若干堆物品，每堆中有一定数量的物品（如石头、豆子或筹码）。
2. 两位玩家轮流操作，每次从一堆中取走至少一个物品，但可以取走任意数量的物品（至多取完）。
3. 无法继续移动的玩家输。

#### 举例
假设当前游戏有三个堆，分别包含 $1, 1, 2$ 个物品。先手玩家可以选择以下几种策略：

- 从第三堆中取走一个物品，使局面变为 $1, 1, 1$。
- 接下来，无论第二个玩家怎么取，都无法避免最终只能取完一个堆，从而输掉游戏。

这个例子展示了在Nim游戏中一个常见的取胜策略：通过调整堆的大小，将局面变成一个“输局”状态，使对手无论怎么走都会输。

#### 胜负判定与基本策略
- **平衡法**：当某局面中有两个堆的大小相等时，第二个玩家（后手）总是可以模仿第一个玩家（先手）的操作，使堆的大小保持平衡，从而在最后获胜。
- **调整堆大小**：若堆的大小不平衡，先手可以通过调整操作使堆的大小相等，从而获胜。

Nim游戏的本质在于找到一个方法，使每次轮到对手时他都处在一个“输局”。

---

### 1.6 Nim堆的表示与递归定义

为了更方便地表达Nim游戏的规则和策略，我们可以使用符号 $\ast n$ 表示一个大小为 $n$ 的Nim堆。其中：
- 若 $n = 0$，即堆为空，此时无合法移动，局面为输局，记作 $\ast 0$。
- 若 $n > 0$，则玩家可以从该堆中取走一定数量的物品，得到一个更小的堆，表示为 $\ast (n - k)$，其中 $1 \leq k \leq n$。

例如：
- 对于大小为 $4$ 的堆 $\ast 4$，玩家可以将其变成 $\ast 3$，$\ast 2$，$\ast 1$ 或 $\ast 0$。

这种表示方法使我们能够将Nim游戏的策略递归化，方便进行数学推导。

---

### 1.7 游戏的和（Game Sum）

组合博弈的一个重要概念是**游戏的和**，即将两个或多个独立的游戏组合成一个新的游戏。在组合的游戏中，玩家可以在每次行动中选择在哪个游戏中移动。对于游戏 $G$ 和 $H$，其和可以表示为 $G + H$，其中规则如下：

- 玩家可以选择在 $G$ 或 $H$ 中进行合法操作，另一个游戏保持不变。

这种组合游戏的和运算提供了分析多个博弈组合的数学工具。

#### 例子
假设 $G$ 和 $H$ 分别表示两个Nim游戏，每个游戏中包含的堆大小为 $(2, 3)$ 和 $(1, 4)$。在 $G + H$ 组合游戏中，玩家可以选择在游戏 $G$ 或 $H$ 中操作。例如：
- 若玩家在 $G$ 中将堆 $(2, 3)$ 变为 $(1, 3)$，则当前状态变为 $((1, 3), (1, 4))$。

#### 公式与性质
1. **等价博弈**：若 $G + H$ 是一个输局，则称 $G$ 和 $H$ 为等价博弈（记作 $G \equiv H$）。
2. **复制原则**（Copycat Principle）：任意博弈 $G$ 与自身相加总是输局，即 $G + G \equiv \ast 0$。

---

### 1.8 等价博弈（Equivalent Games）

等价博弈的概念在组合博弈中非常重要。若两个博弈在任何组合下的输赢结果一致，则称它们是等价的。例如，对于两个博弈 $G$ 和 $H$，若对任意博弈 $J$，以下条件成立：
$$
G + J \text{ 是输局} \iff H + J \text{ 是输局}
$$
则称 $G$ 和 $H$ 等价，记为 $G \equiv H$。

### 证明
1. 选择 $J = \ast 0$ 可以证明，若 $G \equiv H$，则 $G$ 和 $H$ 的输赢性质一致。
2. **等价传递性**：若 $G \equiv H$ 且 $H \equiv K$，则 $G \equiv K$。

例如，若堆大小为 $(1, 2, 3)$，则可以通过异或运算发现其为输局，即 $\ast 1 + \ast 2 + \ast 3 \equiv \ast 0$。

---

### 1.9 Nim堆的和（Nim Sum）与异或运算

Nim游戏的一个关键策略在于利用二进制的**异或运算（XOR）**。在数学上，异或运算可以帮助我们确定一个Nim局面是“赢局”还是“输局”。具体来说，对于两个Nim堆 $\ast n$ 和 $\ast m$，它们的和的大小可以通过以下公式来计算：
$$
k = n \oplus m
$$
其中 $\oplus$ 表示逐位的二进制异或运算。例如，若 $n = 5$ 和 $m = 3$，则它们的二进制分别为 $101$ 和 $011$，计算得到：
$$

5 \oplus 3 = 101_2 \oplus 011_2 = 110_2 = 6
$$
因此，大小为 $5$ 和 $3$ 的两个Nim堆等价于一个大小为 $6$ 的Nim堆。

#### 主定理（Theorem 1.10）：Nim和的推导

对于任意一组堆的组合 $(n_1, n_2, \ldots, n_k)$，我们可以通过以下异或公式计算其等价的单个堆大小：
$$
n_1 \oplus n_2 \oplus \cdots \oplus n_k = r
$$
其中 $r$ 是所有堆大小逐位异或后的结果。若 $r = 0$，则该组合为输局；若 $r \neq 0$，则为赢局。

#### 推导过程

1. 设堆的大小为 $a$ 和 $b$，分别写成二进制。例如，$a = 5$ 和 $b = 3$ 的二进制表示为 $101$ 和 $011$。
2. 逐位异或：对每一位进行异或计算。若两位相同则为 $0$，不同则为 $1$：
   $$
   a \oplus b = 101_2 \oplus 011_2 = 110_2 = 6
   $$
3. 因此，堆大小 $5$ 和 $3$ 的和等价于一个大小为 $6$ 的堆。

---

### 1.10 Nim游戏的赢局与输局判定

基于以上的异或操作，我们可以得出Nim游戏中判断输赢的规则：

1. 计算当前局面中所有堆的异或和，即将每个堆的大小用二进制表示，然后逐位异或。
2. 若异或和为 $0$，则该局面为输局，即当前玩家必败。
3. 若异或和不为 $0$，则该局面为赢局，即当前玩家可以通过选择恰当的移动来赢得游戏。

#### 总结推论
- **异或和为零**的局面是输局（即先手必败，后手必胜）。
- **异或和不为零**的局面是赢局（即先手可以通过最佳移动获胜）。

这种方法利用了Nim游戏的数学结构，使我们能够迅速判断局面的输赢。